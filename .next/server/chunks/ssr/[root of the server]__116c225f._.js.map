{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FPOLY/ky5/ASM_Next/Pure-Botanica/src/app/admin/category/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport \"./category.css\";\r\nimport type { Category } from \"@/app/components/category_interface\";\r\n\r\nexport default function Category() {\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchCategories = async () => {\r\n      try {\r\n        const res = await fetch(\"https://api-zeal.onrender.com/api/categories\");\r\n        const data = await res.json();\r\n        // Filter out hidden categories\r\n        setCategories(data.filter((cat: Category) => !cat.isHidden));\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error(\"Lỗi khi tải danh sách danh mục:\", error);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchCategories();\r\n  }, []);\r\n\r\n  const handleDelete = async (id: string) => {\r\n    if (!confirm(\"Bạn có chắc chắn muốn xử lý danh mục này không?\")) return;\r\n\r\n    try {\r\n      // Check if the category has products\r\n      const resProducts = await fetch(`https://api-zeal.onrender.com/api/categories/${id}/products`);\r\n      const products = await resProducts.json();\r\n\r\n      if (products.length > 0) {\r\n        // Hide the category instead of deleting\r\n        const resHide = await fetch(`https://api-zeal.onrender.com/api/categories/${id}`, {\r\n          method: \"PUT\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify({ isHidden: true }),\r\n        });\r\n\r\n        if (resHide.ok) {\r\n          setCategories((prev) => prev.filter((cat) => cat._id !== id));\r\n          alert(\"Danh mục đã được ẩn vì có sản phẩm!\");\r\n        } else {\r\n          alert(\"Ẩn danh mục thất bại!\");\r\n        }\r\n      } else {\r\n        // Delete the category if it has no products\r\n        const resDelete = await fetch(`https://api-zeal.onrender.com/api/categories/${id}`, {\r\n          method: \"DELETE\",\r\n        });\r\n\r\n        if (resDelete.ok) {\r\n          setCategories((prev) => prev.filter((cat) => cat._id !== id));\r\n          alert(\"Xóa danh mục thành công!\");\r\n        } else {\r\n          alert(\"Xóa danh mục thất bại!\");\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Lỗi khi xử lý danh mục:\", error);\r\n      alert(\"Đã xảy ra lỗi khi xử lý danh mục.\");\r\n    }\r\n  };\r\n\r\n  const handleEdit = (id: string) => {\r\n    const category = categories.find((cat) => cat._id === id);\r\n    if (category) {\r\n      setEditingCategory(category);\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async (id: string, updatedName: string) => {\r\n    try {\r\n      const res = await fetch(`https://api-zeal.onrender.com/api/categories/${id}`, {\r\n        method: \"PUT\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ name: updatedName }),\r\n      });\r\n\r\n      if (res.ok) {\r\n        setCategories((prev) =>\r\n          prev.map((cat) =>\r\n            cat._id === id ? { ...cat, name: updatedName } : cat\r\n          )\r\n        );\r\n        setEditingCategory(null);\r\n        alert(\"Cập nhật danh mục thành công!\");\r\n      } else {\r\n        alert(\"Cập nhật danh mục thất bại!\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Lỗi khi cập nhật danh mục:\", error);\r\n      alert(\"Đã xảy ra lỗi khi cập nhật danh mục.\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <p className=\"text-center py-10\">Đang tải danh sách danh mục...</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container-category\">\r\n      <div className=\"form-table-category\">\r\n        <div className=\"name-table-category\">\r\n          <span>Danh Mục Sản Phẩm</span>\r\n          <div className=\"form-btn-add-new-category\">\r\n            <button className=\"btn-add-new-category\">\r\n              <a href=\"/admin/add_category\">Thêm danh mục sản phẩm</a>\r\n            </button>\r\n          </div>\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>Tên Danh Mục</th>\r\n                <th>Hành Động</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {categories.map((category) => (\r\n                <tr key={category._id}>\r\n                  <td>\r\n                    {editingCategory?._id === category._id ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingCategory.name}\r\n                        onChange={(e) =>\r\n                          setEditingCategory({\r\n                            ...editingCategory,\r\n                            name: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"edit-input\"\r\n                      />\r\n                    ) : (\r\n                      category.name\r\n                    )}\r\n                  </td>\r\n                  <td>\r\n                    {editingCategory?._id === category._id ? (\r\n                      <>\r\n                        <button\r\n                          className=\"btn-save\"\r\n                          onClick={() =>\r\n                            handleUpdate(category._id, editingCategory.name)\r\n                          }\r\n                        >\r\n                          Lưu\r\n                        </button>\r\n                        <button\r\n                          className=\"btn-cancel\"\r\n                          onClick={() => setEditingCategory(null)}\r\n                        >\r\n                          Hủy\r\n                        </button>\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <button\r\n                          className=\"btn-edit\"\r\n                          onClick={() => handleEdit(category._id)}\r\n                        >\r\n                          Chỉnh sửa\r\n                        </button>\r\n                        <button\r\n                          className=\"btn-remove\"\r\n                          onClick={() => handleDelete(category._id)}\r\n                        >\r\n                          Xóa\r\n                        </button>\r\n                      </>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 301, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FPOLY/ky5/ASM_Next/Pure-Botanica/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":";AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,MAAQ;;AAEzC,OAAO;IACL,IAAIF,QAAQC,GAAG,CAACK,uBAA2B,EAAF;;IAQzC,OAAO;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1CJ,OAAOC,OAAO,GAAGC,QAAQ;QAC3B,OAAO,IAAIL,QAAQC,GAAG,CAACO,SAAS,EAAE;;QAIlC;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FPOLY/ky5/ASM_Next/Pure-Botanica/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CACxD,YACD,CAACC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FPOLY/ky5/ASM_Next/Pure-Botanica/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored['react-ssr'].React\n"],"names":["module","exports","require","vendored","React"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CAAC,YAAY,CAACC,KAAK","ignoreList":[0],"debugId":null}}]
}